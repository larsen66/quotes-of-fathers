# ФУНКЦИОНАЛЬНЫЕ ТРЕБОВАНИЯ

## Админ-панель «Цитаты Отцов»

## 1. Общие положения

### FR-A0-1. Назначение

Админ-панель предназначена для управления контентом мобильного приложения:

* сущности **Отцы (Father)**
* сущности **Цитаты (Quote)**
* счётчик подписчиков (для экрана «О нас»)
* обработка сообщений обратной связи (Feedback)

### FR-A0-2. Роли и доступ

* **FR-A0-2.1:** Система должна поддерживать роль **Администратор** (полный доступ).
* **FR-A0-2.2 (опц.):** Роль **Редактор** (создание/редактирование контента без удаления и без управления пользователями).

### FR-A0-3. Аутентификация

* **FR-A0-3.1:** Вход в админ-панель должен требовать авторизацию (логин/пароль).
* **FR-A0-3.2:** После входа админ видит главную страницу/дашборд.

---

## 2. Структура админ-панели (разделы)

### FR-A1-1. Разделы меню

Админ-панель должна содержать пункты:

1. Дашборд
2. Отцы
3. Цитаты
4. Подписчики (счётчик)
5. Обратная связь
6. Настройки (опционально: общие параметры проекта)

---

## 3. Дашборд

### FR-A2-1. Сводные показатели

Дашборд должен отображать:

* количество отцов (Father count)
* количество опубликованных цитат (Quote where isPublished=true)
* количество черновиков/неопубликованных цитат
* количество новых сообщений обратной связи (непрочитанных)

### FR-A2-2. Быстрые действия

На дашборде должны быть кнопки:

* “Добавить отца”
* “Добавить цитату”

---

## 4. Раздел «Отцы» (Father Management)

### FR-A3-1. Список отцов

* **FR-A3-1.1:** Админ-панель должна отображать список отцов таблицей.
* **FR-A3-1.2:** Колонки списка: Фото (avatar), Имя, Кол-во цитат, Статус (опц.), Дата создания, Дата изменения.
* **FR-A3-1.3:** Должны быть доступны поиск по имени и сортировка.

### FR-A3-2. Создание отца

* **FR-A3-2.1:** Должна быть форма создания отца со следующими полями:

  * `name_ka` (обязательное) — имя на грузинском
  * `name_ru` (опционально) — имя на русском
  * `avatarUrl` (обязательное) — загрузка изображения или указание URL
  * `profileImageUrl` (опционально) — загрузка изображения или URL
  * `bio_ka` (опционально) — биография на грузинском
  * `bio_ru` (опционально) — биография на русском
  * `order` (опционально)
* **FR-A3-2.2:** При сохранении создаются `createdAt` и `updatedAt`.

### FR-A3-3. Редактирование отца

* **FR-A3-3.1:** Админ должен иметь возможность редактировать все поля отца.
* **FR-A3-3.2:** При сохранении обновляется `updatedAt`.

### FR-A3-4. Удаление отца

* **FR-A3-4.1:** Админ должен иметь возможность удалить отца.
* **FR-A3-4.2:** При удалении система должна обработать связанные цитаты одним из правил (зафиксировать в настройках проекта):

  * Вариант A: запретить удаление, если есть цитаты
  * Вариант B: каскадное удаление цитат
  * Вариант C: перевод цитат в “без автора” (не рекомендуется)
* **FR-A3-4.3:** Удаление должно требовать подтверждения.

---

## 5. Раздел «Цитаты» (Quote Management)

### FR-A4-1. Список цитат

* **FR-A4-1.1:** Админ-панель должна отображать список цитат таблицей.
* **FR-A4-1.2:** Колонки: Отец, Превью текста (первые N символов), Дата добавления (`createdAt`), Статус публикации (`isPublished`), Дата изменения (`updatedAt`).
* **FR-A4-1.3:** Должны быть фильтры:

  * по отцу
  * по статусу (опубликовано/черновик)
  * поиск по тексту (минимум подстрока)
* **FR-A4-1.4:** Сортировки:

  * по `createdAt` (по умолчанию DESC)
  * по `updatedAt`

### FR-A4-2. Создание цитаты

* **FR-A4-2.1:** Должна быть форма создания цитаты со следующими полями:

  * `fatherId` (обязательное) — выбор из списка отцов
  * `text_ka` (обязательное) — полный текст на грузинском
  * `text_ru` (опционально) — полный текст на русском
  * `quoteDate` (опционально)
  * `source_ka` (опционально) — источник на грузинском
  * `source_ru` (опционально) — источник на русском
  * `tags` (опционально)
  * `isPublished` (обязательное, по умолчанию true или false — фиксируется в настройках)
* **FR-A4-2.2:** `createdAt` должен выставляться автоматически как дата/время добавления в админ-панели.
* **FR-A4-2.3:** При сохранении устанавливается `updatedAt`.

### FR-A4-3. Редактирование цитаты

* **FR-A4-3.1:** Админ должен иметь возможность редактировать поля цитаты.
* **FR-A4-3.2:** При редактировании обновляется `updatedAt`.
* **FR-A4-3.3:** Должна быть возможность переключать `isPublished`.

### FR-A4-4. Удаление цитаты

* **FR-A4-4.1:** Админ должен иметь возможность удалить цитату.
* **FR-A4-4.2:** Удаление должно требовать подтверждения.

### FR-A4-5. Массовые операции (опционально, но полезно)

* **FR-A4-5.1:** Массовая смена статуса публикации (publish/unpublish).
* **FR-A4-5.2:** Массовое удаление.
* **FR-A4-5.3:** Импорт цитат из CSV (с маппингом полей отец/текст/дата).

---

## 6. Раздел «Подписчики» (Subscribers Count)

### FR-A5-1. Просмотр счётчика

* **FR-A5-1.1:** Админ-панель должна показывать текущее значение `subscribersCount`.

### FR-A5-2. Редактирование счётчика

* **FR-A5-2.1:** Админ должен иметь возможность вручную изменить значение счётчика.
* **FR-A5-2.2:** При изменении обновляется `updatedAt`.

*(Если счётчик будет считаться автоматически на сервере — этот раздел превращается в “только просмотр”.)*

---

## 7. Раздел «Обратная связь» (Feedback)

### FR-A6-1. Список сообщений

* **FR-A6-1.1:** Админ-панель должна отображать список входящих сообщений.
* **FR-A6-1.2:** Поля: дата, контакт, превью сообщения, статус (прочитано/не прочитано).

### FR-A6-2. Просмотр сообщения

* **FR-A6-2.1:** Админ может открыть сообщение и увидеть полный текст.
* **FR-A6-2.2:** При открытии сообщение помечается как “прочитано” (или кнопкой).

### FR-A6-3. Экспорт (опционально)

* **FR-A6-3.1:** Возможность выгрузить сообщения в CSV.

---

## 8. Управление медиа (изображения)

### FR-A7-1. Загрузка изображений

* **FR-A7-1.1:** Админ-панель должна позволять загружать изображения для `avatarUrl` и `profileImageUrl`.
* **FR-A7-1.2:** После загрузки система возвращает публичный URL.

### FR-A7-2. Валидация медиа

* **FR-A7-2.1:** Допустимые форматы: JPG/PNG/WebP.
* **FR-A7-2.2:** Ограничение размера файла (задаётся параметром, например до 5–10 МБ).
* **FR-A7-2.3:** Система должна отклонять неподдерживаемые форматы.

---

## 9. Синхронизация с мобильным приложением (контентные правила)

### FR-A8-1. Источник истины

* **FR-A8-1.1:** Серверные данные админ-панели являются источником истины для Fathers/Quotes.

### FR-A8-2. “Последние цитаты”

* **FR-A8-2.1:** Мобильное приложение должно получать “последние” по полю `createdAt` (дата добавления в админ-панели).
* **FR-A8-2.2:** Админ-панель должна гарантировать наличие `createdAt` у каждой цитаты.

### FR-A8-3. Публикация

* **FR-A8-3.1:** Цитаты с `isPublished=false` не должны попадать в мобильное приложение.

---

## 10. Валидация и ошибки

### FR-A9-1. Валидация

* **FR-A9-1.1:** Поля `Father.name_ka`, `Father.avatarUrl`, `Quote.fatherId`, `Quote.text_ka` обязательны.
* **FR-A9-1.2:** При ошибке валидации должна отображаться подсказка, сохранение блокируется.

### FR-A9-2. Аудит изменений (опционально)

* **FR-A9-2.1:** Система может хранить кто и когда изменил запись (createdBy/updatedBy).

---

## 11. Мультиязычность

### FR-A10-1. Поддерживаемые языки

* **FR-A10-1.1:** Админ-панель должна поддерживать два языка интерфейса:
  * **Грузинский (ka)** — основной язык
  * **Русский (ru)** — дополнительный язык
* **FR-A10-1.2:** Язык интерфейса выбирается в настройках пользователя

### FR-A10-2. Язык интерфейса админ-панели

* **FR-A10-2.1:** Все элементы интерфейса (меню, кнопки, заголовки, сообщения) должны отображаться на выбранном языке.
* **FR-A10-2.2:** Переключение языка должно быть доступно в настройках профиля или в шапке админ-панели.
* **FR-A10-2.3:** Выбранный язык сохраняется в настройках пользователя.

### FR-A10-3. Мультиязычный контент — Отцы

* **FR-A10-3.1:** При создании/редактировании отца должны быть доступны поля для обоих языков:
  * `name_ka` (обязательное) — имя на грузинском
  * `name_ru` (опционально) — имя на русском
  * `bio_ka` (опционально) — биография на грузинском
  * `bio_ru` (опционально) — биография на русском
* **FR-A10-3.2:** В списке отцов отображается имя на текущем языке интерфейса (при отсутствии — на грузинском).
* **FR-A10-3.3:** При отсутствии перевода на выбранный язык система должна использовать грузинский как fallback.

### FR-A10-4. Мультиязычный контент — Цитаты

* **FR-A10-4.1:** При создании/редактировании цитаты должны быть доступны поля для обоих языков:
  * `text_ka` (обязательное) — текст цитаты на грузинском
  * `text_ru` (опционально) — текст цитаты на русском
  * `source_ka` (опционально) — источник на грузинском
  * `source_ru` (опционально) — источник на русском
* **FR-A10-4.2:** В списке цитат отображается текст на текущем языке интерфейса (при отсутствии — на грузинском).
* **FR-A10-4.3:** При отсутствии перевода на выбранный язык система должна использовать грузинский как fallback.

### FR-A10-5. API и синхронизация

* **FR-A10-5.1:** API должно поддерживать параметр `lang` (ka/ru) для получения контента на выбранном языке.
* **FR-A10-5.2:** При отсутствии параметра `lang` API возвращает контент на грузинском языке (по умолчанию).
* **FR-A10-5.3:** Мобильное приложение должно получать контент на языке, выбранном пользователем в настройках приложения.
